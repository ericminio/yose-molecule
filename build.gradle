apply plugin: 'java'
apply plugin: 'application'
apply plugin: 'jacoco'

defaultTasks 'build'

repositories {
    mavenCentral()
    maven {
        url 'https://oss.sonatype.org/content/repositories/snapshots/'
    }
}

def libs = [
        gson              : 'com.google.code.gson:gson:2.2.4',
        molecule          : 'com.vtence.molecule:molecule:0.4-SNAPSHOT',
        simple            : 'org.simpleframework:simple:5.1.6',
        hamcrest_all      : 'org.hamcrest:hamcrest-all:1.3',
        junit             : 'junit:junit:4.11@jar',
        htmlunit          : 'net.sourceforge.htmlunit:htmlunit:2.14',
        molecule_test     : 'com.vtence.molecule:molecule:0.4-SNAPSHOT:tests',
]

dependencies {
    compile libs.gson
    compile libs.molecule
    compile libs.simple

    testCompile libs.hamcrest_all
    testCompile libs.junit
    testCompile libs.htmlunit
    testCompile libs.molecule_test
}

mainClassName = 'yose.Yose'
applicationName = 'yose-molecule'

run {
    if (!project.hasProperty('port')) ext.port = 8080
    args port
}

jacocoTestReport {
    reports {
        xml.enabled = true // coveralls plugin depends on xml format report
        html.enabled = true
    }
}

task coverage(dependsOn: ['test', 'jacocoTestReport'])

task wrapper(type: Wrapper) {
    gradleVersion = '2.1'
}

task stage(dependsOn: ['clean', 'installApp'])